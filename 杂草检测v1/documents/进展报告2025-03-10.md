# æ‚è‰ç›–åº¦ä¸å¯†åº¦ä¼°è®¡é¡¹ç›®è¿›å±•æŠ¥å‘Š

### ä¼ ç»Ÿæ–¹æ¡ˆ

1. **å›¾åƒæ ¡å‡†**ï¼šä½¿ç”¨é€è§†å˜æ¢å°†é€‰å®šçš„å››è¾¹å½¢åŒºåŸŸè½¬æ¢ä¸ºæ ‡å‡†çš„ 500x500 åƒç´ æ­£æ–¹å½¢ï¼Œä»£è¡¨ 1 å¹³æ–¹ç±³åŒºåŸŸã€‚
2. **è‰çš„åˆ†å‰²**ï¼šHSV æ–¹æ³•ï¼šåŸºäº **HSV** é¢œè‰²ç©ºé—´çš„é˜ˆå€¼åˆ†å‰²ï¼Œé€‚ç”¨äºè‰ä¸èƒŒæ™¯é¢œè‰²å¯¹æ¯”æ˜æ˜¾çš„æƒ…å†µ
3. **ç›–åº¦è®¡ç®—**ï¼šè‰çš„åƒç´ æ•° / æ€»åŒºåŸŸåƒç´ æ•° Ã— 100%
4. **å¯†åº¦è®¡ç®—**ï¼šä½¿ç”¨**åˆ†æ°´å²­ç®—æ³•**è¿›è¡Œå®ä¾‹åˆ†å‰²ï¼Œè®¡ç®—è‰çš„å®ä¾‹æ•°é‡

#### æ–¹æ¡ˆç»†èŠ‚

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#4285F4',
    'primaryTextColor': '#ffffff',
    'primaryBorderColor': '#2a75f3',
    'lineColor': '#555555',
    'secondaryColor': '#34A853',
    'tertiaryColor': '#FBBC05',
    'fontFamily': 'Microsoft YaHei, Arial, sans-serif',
    'fontSize': '16px',
    'curve': 'basis'
  },
  'flowchart': {
    'htmlLabels': true,
    'curve': 'basis',
    'diagramPadding': 20
  }
}}%%

flowchart TB
    %% å®šä¹‰ç°ä»£åŒ–é«˜çº§æ ·å¼
    classDef processClass fill:#E3F2FD,stroke:#1E88E5,stroke-width:2px,color:#0D47A1,rx:8,ry:8
    classDef decisionClass fill:#FFF8E1,stroke:#FFA000,stroke-width:2px,color:#E65100
    classDef dataClass fill:#E8F5E9,stroke:#43A047,stroke-width:2px,color:#1B5E20,rx:12,ry:12
    classDef startClass fill:#651FFF,color:white,stroke:#4527A0,stroke-width:2px,rx:20,ry:20
    classDef endClass fill:#2979FF,color:white,stroke:#1565C0,stroke-width:2px,rx:20,ry:20
    classDef noteClass fill:#FFF3E0,stroke:#FF6E40,stroke-width:1px,color:#BF360C,stroke-dasharray:5,5,rx:4,ry:4
    classDef subgraphClass fill:#FAFAFA,stroke:#BDBDBD,stroke-width:1px,color:#424242,rx:10,ry:10
    
    %% å¼€å§‹èŠ‚ç‚¹
    Start([" ğŸš€ å¼€å§‹æ‚è‰åˆ†æ "]):::startClass
    
    %% å›¾åƒé¢„å¤„ç†é˜¶æ®µ
    subgraph PreProcess[" ğŸ“¸ 1. å›¾åƒé¢„å¤„ç† "]
        direction TB
        Load[" åŠ è½½å›¾åƒ<br><i>cv2.imread</i> "]:::processClass
        Calibrate[" å›¾åƒæ ¡å‡†<br><i>é€è§†å˜æ¢æ ¡æ­£</i> "]:::processClass
        
        Load --> |" åŸå§‹å›¾åƒ "| Calibrate
        
        style PreProcess fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,rx:15,ry:15
    end
    
    %% è‰åœ°åˆ†å‰²é˜¶æ®µ
    subgraph Segmentation[" ğŸŒ¿ 2. è‰åœ°åˆ†å‰² "]
        direction TB
        HSV[" è½¬æ¢ä¸ºHSVé¢œè‰²ç©ºé—´<br><i>å¢å¼ºç»¿è‰²åŒºåˆ†åº¦</i> "]:::processClass
        AdaptiveThresh[" è‡ªé€‚åº”é˜ˆå€¼åˆ†å‰²<br><i>cv2.inRange</i> "]:::processClass
        Morphology[" å½¢æ€å­¦æ“ä½œ<br><i>å¼€è¿ç®—å’Œé—­è¿ç®—</i> "]:::processClass
        RemoveSmall[" ç§»é™¤å°åŒºåŸŸ<br><i>connectedComponents</i> "]:::processClass
        HSVMask[(" ç”ŸæˆHSVæ©ç <br><i>äºŒå€¼å›¾åƒ</i> ")]:::dataClass
        
        HSV --> |" é¢œè‰²è½¬æ¢ "| AdaptiveThresh
        AdaptiveThresh --> |" åˆæ­¥åˆ†å‰² "| Morphology
        Morphology --> |" ä¼˜åŒ–è¾¹ç•Œ "| RemoveSmall
        RemoveSmall --> |" è¿‡æ»¤å™ªå£° "| HSVMask
        
        style Segmentation fill:#E0F2F1,stroke:#00897B,stroke-width:2px,rx:15,ry:15
    end
    
    %% ç›–åº¦è®¡ç®—é˜¶æ®µ
    subgraph Coverage[" ğŸ“Š 3. ç›–åº¦è®¡ç®— "]
        direction TB
        CountGrass[" è®¡ç®—è‰çš„åƒç´ æ•°<br><i>np.sum(hsv_mask > 0)</i> "]:::processClass
        CountTotal[" è®¡ç®—æ€»åƒç´ æ•°<br><i>hsv_mask.size</i> "]:::processClass
        CalcCoverage[" è®¡ç®—ç›–åº¦ç™¾åˆ†æ¯”<br><i>grass_pixels / total_pixels * 100</i> "]:::processClass
        CoverageResult[(" ç›–åº¦ç»“æœ<br><i>ç™¾åˆ†æ¯”</i> ")]:::dataClass
        
        CountGrass --> |" å‰æ™¯åƒç´  "| CountTotal
        CountTotal --> |" æ€»åƒç´  "| CalcCoverage
        CalcCoverage --> CoverageResult
        
        style Coverage fill:#F3E5F5,stroke:#8E24AA,stroke-width:2px,rx:15,ry:15
    end
    
    %% å®ä¾‹åˆ†å‰²é˜¶æ®µ
    subgraph InstanceSeg[" ğŸ” 4. å®ä¾‹åˆ†å‰² "]
        direction TB
        PreprocessMask[" HSVæ©ç é¢„å¤„ç†<br><i>å¢å¼ºè¿é€šæ€§</i> "]:::processClass
        DistTransform[" è·ç¦»å˜æ¢<br><i>cv2.distanceTransform</i> "]:::processClass
        
        MethodChoice{" é€‰æ‹©åˆ†å‰²æ–¹æ³• "}:::decisionClass
        Watershed[" åˆ†æ°´å²­ç®—æ³•<br><i>cv2.watershed</i> "]:::processClass
        LocalMax[" å±€éƒ¨æå¤§å€¼æ–¹æ³•<br><i>peak_local_max</i> "]:::processClass
        
        RemoveInstances[" ç§»é™¤å°å®ä¾‹<br><i>é¢ç§¯è¿‡æ»¤</i> "]:::processClass
        Instances[(" ç”Ÿæˆå®ä¾‹æ ‡è®°<br><i>å”¯ä¸€IDæ ‡è¯†</i> ")]:::dataClass
        
        PreprocessMask --> |" é¢„å¤„ç† "| DistTransform
        DistTransform --> |" è·ç¦»å›¾ "| MethodChoice
        MethodChoice -->|" å¤æ‚å½¢çŠ¶ "| Watershed
        MethodChoice -->|" ç®€å•å½¢çŠ¶ "| LocalMax
        Watershed --> |" æ ‡è®°å›¾ "| RemoveInstances
        LocalMax --> |" æ ‡è®°å›¾ "| RemoveInstances
        RemoveInstances --> |" è¿‡æ»¤ "| Instances
        
        style InstanceSeg fill:#FFF3E0,stroke:#F57C00,stroke-width:2px,rx:15,ry:15
    end
    
    %% å¯†åº¦è®¡ç®—é˜¶æ®µ
    subgraph Density[" ğŸ“ˆ 5. å¯†åº¦è®¡ç®— "]
        direction TB
        ChooseMethod{" é€‰æ‹©å¯†åº¦<br>è®¡ç®—æ–¹æ³• "}:::decisionClass
        
        InstanceCount[" åŸºäºå®ä¾‹è®¡æ•°<br><i>è®¡ç®—å”¯ä¸€æ ‡ç­¾æ•°é‡</i> "]:::processClass
        AreaBased[" åŸºäºé¢ç§¯ä¼°è®¡<br><i>grass_area / avg_plant_size</i> "]:::processClass
        Combined[" ç»„åˆæ–¹æ³•<br><i>æƒé‡ç»“åˆä¸¤ç§æ–¹æ³•</i> "]:::processClass
        DensityResult[(" å¯†åº¦ç»“æœ<br><i>æ ª/å¹³æ–¹ç±³</i> ")]:::dataClass
        
        ChooseMethod -->|" åˆ†ç¦»è‰¯å¥½ "| InstanceCount
        ChooseMethod -->|" é‡å ä¸¥é‡ "| AreaBased
        ChooseMethod -->|" æ··åˆæƒ…å†µ "| Combined
        InstanceCount --> DensityResult
        AreaBased --> DensityResult
        Combined --> DensityResult
        
        style Density fill:#E8F5E9,stroke:#43A047,stroke-width:2px,rx:15,ry:15
    end
    
    %% ç»“æŸèŠ‚ç‚¹
    End([" ğŸ† è¾“å‡ºæœ€ç»ˆç»“æœ:<br>ç›–åº¦ç™¾åˆ†æ¯” + å¯†åº¦ä¼°è®¡ "]):::endClass
    
    %% ä¸»æµç¨‹è¿æ¥ - ä½¿ç”¨æ›²çº¿è¿æ¥å¢å¼ºç°ä»£æ„Ÿ
    Start -.-> PreProcess
    PreProcess -.-> Segmentation
    Segmentation -.-> |" åˆ†å‰å¤„ç† "| HSVMask
    HSVMask -.-> |" è®¡ç®—å æ¯” "| Coverage
    HSVMask -.-> |" å®ä¾‹è¯†åˆ« "| InstanceSeg
    Coverage -.-> |" ç›–åº¦æ•°æ® "| End
    InstanceSeg -.-> |" å®ä¾‹æ•°æ® "| Density
    Density -.-> |" å¯†åº¦æ•°æ® "| End

    %% æ·»åŠ è¯´æ˜æ³¨é‡Š - ä½¿ç”¨ç°ä»£åŒ–çš„å›¾æ ‡å’Œæ ¼å¼
    subgraph Parameters[" âš™ï¸ å…³é”®å‚æ•°è¯´æ˜ "]
        direction TB
        HSVNote[" ğŸ¨ HSVé˜ˆå€¼:<br>â€¢ H: 35-90 (ç»¿è‰²)<br>â€¢ S: >40<br>â€¢ V: >25 "]:::noteClass
        MorphNote[" ğŸ”§ å½¢æ€å­¦å‚æ•°:<br>â€¢ kernel_size = 5x5<br>â€¢ iterations = 1 "]:::noteClass
        MinSizeNote[" ğŸ“ æœ€å°åŒºåŸŸé˜ˆå€¼:<br>â€¢ min_size = 50 * (image_size/250000) "]:::noteClass
        DensityNote[" ğŸ“Š å¯†åº¦ä¼°è®¡ç­–ç•¥:<br>â€¢ å®ä¾‹è®¡æ•°: åˆ†ç¦»è‰¯å¥½æ—¶<br>â€¢ é¢ç§¯ä¼°è®¡: é‡å ä¸¥é‡æ—¶<br>â€¢ ç»„åˆæ–¹æ³•: æ··åˆæƒ…å†µ "]:::noteClass
        
        style Parameters fill:#FAFAFA,stroke:#9E9E9E,stroke-width:1px,rx:15,ry:15
    end
```

```mermaid
graph TD;
    A[å¼€å§‹] --> B[åˆå§‹åŒ–GrassAnalyzer]
    B --> C[åŠ è½½å›¾åƒ]
    C --> D{æ ¡å‡†ç‚¹æ˜¯å¦æä¾›}
    D -- æ˜¯ --> E[ä½¿ç”¨æä¾›çš„æ ¡å‡†ç‚¹]
    D -- å¦ --> F[åŠ è½½æ ¡å‡†æ–‡ä»¶]
    F --> G{æ ¡å‡†æ–‡ä»¶æ˜¯å¦å­˜åœ¨}
    G -- æ˜¯ --> H[ä»æ ¡å‡†æ–‡ä»¶åŠ è½½æ ¡å‡†ç‚¹]
    G -- å¦ --> I[ä½¿ç”¨æ•´ä¸ªå›¾åƒè¿›è¡Œåˆ†æ]
    H --> J[æ ¡å‡†å›¾åƒ]
    I --> J
    J --> K[åˆ†å‰²è‰]
    K --> L[è®¡ç®—è‰çš„è¦†ç›–åº¦]
    L --> M[è®¡ç®—è‰çš„å¯†åº¦]
    M --> N[å¯è§†åŒ–ç»“æœ]
    N --> O[ç»“æŸ]

    subgraph æ ¡å‡†å›¾åƒ
        E --> J
        H --> J
    end

    subgraph åˆ†å‰²è‰
        K --> P[å›¾åƒé¢„å¤„ç†]
        P --> Q[è®¡ç®—é˜ˆå€¼]
        Q --> R[ç”Ÿæˆæ©ç ]
        R --> S[å½¢æ€å­¦æ“ä½œ]
        S --> T[åˆ†æ°´å²­ç®—æ³•]
    end

    subgraph è®¡ç®—è¦†ç›–åº¦å’Œå¯†åº¦
        L --> U[è®¡ç®—è‰çš„åƒç´ æ•°]
        U --> V[è®¡ç®—æ€»åƒç´ æ•°]
        V --> W[è®¡ç®—è¦†ç›–åº¦]
        M --> X[è®¡ç®—å®ä¾‹æ•°é‡]
        X --> Y[è®¡ç®—åŸºäºé¢ç§¯çš„è‰çš„æ•°é‡]
        Y --> Z[è¿”å›è‰çš„å¯†åº¦]
    end

    subgraph å¯è§†åŒ–ç»“æœ
        N --> AA[ç”Ÿæˆå¯è§†åŒ–å›¾åƒ]
        AA --> AB[ä¿å­˜ç»“æœ]
    end
```

#### æ•ˆæœæ¼”ç¤º

![00001.jpg_traditional_analysis](assets/00001.jpg_traditional_analysis-1741614130154-8.png)

### æ·±åº¦å­¦ä¹ æ–¹æ¡ˆ

> [!note]
>
> è¯¥æ–¹æ³•æ¬²æƒ³è¾¾åˆ°è¾ƒå¥½çš„è¯†åˆ«æ•ˆæœé¢„æµ‹éœ€è¦ä½¿ç”¨ç›®æ ‡æ•°æ®é›†è¿›è¡Œé’ˆå¯¹è®­ç»ƒ

1. **å›¾åƒæ ¡å‡†**ï¼šä¸ä¼ ç»Ÿæ–¹æ³•ç›¸åŒï¼Œä½¿ç”¨é€è§†å˜æ¢ã€‚

2. **è‰çš„åˆ†å‰²**ï¼š

    - ä½¿ç”¨é¢„è®­ç»ƒçš„ DeepLabV3 ResNet50 æ¨¡å‹è¿›è¡Œè¯­ä¹‰åˆ†å‰²
    - ç»“åˆå¤šç§é¢œè‰²ç©ºé—´ï¼ˆHSVã€LABï¼‰å’Œ K-means èšç±»è¿›è¡Œå¢å¼ºåˆ†å‰²
    - è‡ªé€‚åº”å‚æ•°è°ƒæ•´ï¼šæ ¹æ®å›¾åƒç‰¹æ€§è‡ªåŠ¨è°ƒæ•´åˆ†å‰²å‚æ•°
    - å¤šæ¨¡å‹é›†æˆï¼šç»“åˆæ·±åº¦å­¦ä¹ é¢„æµ‹å’Œé¢œè‰²ç‰¹å¾

3. **ç›–åº¦è®¡ç®—**ï¼šä¸ä¼ ç»Ÿæ–¹æ³•ç›¸åŒï¼ŒåŸºäºåˆ†å‰²æ©ç è®¡ç®—ã€‚

4. **å¯†åº¦è®¡ç®—**ï¼š
    - ä½¿ç”¨è¿é€šç»„ä»¶åˆ†æä¼°è®¡è‰çš„æ•°é‡
    - å¯¹äºå¤æ‚åœºæ™¯ï¼Œä½¿ç”¨è·ç¦»å˜æ¢å’Œå±€éƒ¨æå¤§å€¼æ£€æµ‹è¿›è¡Œå¢å¼ºä¼°è®¡
    - è‡ªåŠ¨è¿‡æ»¤å°åŒºåŸŸï¼Œæé«˜å¯†åº¦ä¼°è®¡å‡†ç¡®æ€§

5. **è‡ªé€‚åº”æœºåˆ¶**ï¼š
    - è‡ªåŠ¨æ£€æµ‹è¿‡åº¦åˆ†å‰²ï¼Œå¹¶åº”ç”¨æ›´ä¸¥æ ¼çš„åˆ†å‰²æ¡ä»¶
    - æ ¹æ®å›¾åƒç‰¹æ€§è‡ªåŠ¨è°ƒæ•´ HSV é˜ˆå€¼å’Œå…¶ä»–å‚æ•°
    - å¤šç§å¤‡ç”¨ç­–ç•¥ï¼Œç¡®ä¿åœ¨å„ç§åœºæ™¯ä¸‹éƒ½èƒ½å¾—åˆ°åˆç†ç»“æœ



## å½“å‰ä¼°è®¡ç»“æœï¼ˆä¼ ç»Ÿæ–¹æ³•ï¼‰

| æ•°æ®æ–‡ä»¶ | ç›–åº¦ (%) | å¯†åº¦ (æ ª/å¹³æ–¹ç±³) |
| :------: | :------: | :--------------: |
|  00001   |  41.18   |        72        |
|  00002   |  51.24   |        73        |
|  00003   |  51.88   |        67        |
|  00004   |  50.46   |        55        |
|  00005   |  46.53   |        70        |
|  00006   |  48.34   |        62        |
|  00007   |  33.88   |        78        |
|  00008   |  42.93   |        84        |
|  00009   |  37.14   |        60        |
|  000010  |  40.24   |        55        |
|  000011  |  45.05   |        87        |
|  000012  |  45.71   |        81        |

00001

![00001.jpg_traditional_analysis](assets/00001.jpg_traditional_analysis-1741614789877-10.png)

00002

![00002.jpg_traditional_analysis](assets/00002.jpg_traditional_analysis-1741614799059-12.png)

00003

![00003.jpg_traditional_analysis](assets/00003.jpg_traditional_analysis.png)

00004

![00004.jpg_traditional_analysis](assets/00004.jpg_traditional_analysis.png)

00005

![00005.jpg_traditional_analysis](assets/00005.jpg_traditional_analysis.png)

00006

![00006.jpg_traditional_analysis](assets/00006.jpg_traditional_analysis.png)

00007

![00007.jpg_traditional_analysis](assets/00007.jpg_traditional_analysis.png)

00008

![00008.jpg_traditional_analysis](assets/00008.jpg_traditional_analysis.png)

00009

![00009.jpg_traditional_analysis](assets/00009.jpg_traditional_analysis.png)

000010

![00010.jpg_traditional_analysis](assets/00010.jpg_traditional_analysis.png)

000011

![00011.jpg_traditional_analysis](assets/00011.jpg_traditional_analysis.png)

000012

![00012.jpg_traditional_analysis](assets/00012.jpg_traditional_analysis.png)
